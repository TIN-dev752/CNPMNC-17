@{
    ViewBag.Title = "ThongKeDoanhThu";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

<style>
    #doanhThuChart {
        width: 1000px; 
        height: 500px;
        margin: 0 auto; 
    }

    form {
        width: max-content;
        margin: 0 auto;
        display: flex;
        justify-content: center;
        margin-bottom: 30px;
        padding: 10px 20px;
        background-color: rgba(75, 192, 192, 0.2);
        border: 1px dashed rgba(75, 192, 192, 1);
    }

    label {
        margin-right: 15px;
        font-weight: 600;
    }

    button {
        border: none;
        border-radius: 6px;
        outline: none;
        margin-left: 20px;
        font-size: 12px;
        padding: 2px 10px;
        background-color: rgba(75, 192, 192, 1);
        color: white;
        font-weight: 600;
    }

</style>
<div class="container">
    <h2 style="text-align: center; font-weight: bold; margin-bottom: 30px;">Quản lý doanh thu</h2>
    <form method="get" action="@Url.Action("ThongKeDoanhThu", "Admin")">
        <div class="d-flex align-items-center" style="margin-right: 30px;">
            <label for="month">Chọn tháng:</label>
            <select name="month" id="month">
                @for (int i = 1; i <= 12; i++)
                {
                    <option value="@i" @(i == ViewBag.Thang ? "selected" : "")>@i</option>
                }
            </select>
        </div>
        <div class="d-flex align-items-center">
            <label for="year">Chọn năm:</label>
            <select name="year" id="year">
                @for (int i = DateTime.Now.Year; i >= 2000; i--)
                {
                    <option value="@i" @(i == ViewBag.Nam ? "selected" : "")>@i</option>
                }
            </select>
        </div>
        <button type="submit">Thống kê</button>
    </form>
    <div style="width: 1000px; height: 500px; margin: 0 auto;">
        <p>Doanh thu tháng @ViewBag.Thang, năm @ViewBag.Nam:</p>
        <canvas id="doanhThuChart" width="100" height="50"></canvas>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    var danhSachDoanhThu = @Html.Raw(ViewBag.DanhSachDoanhThu);

    var labels = danhSachDoanhThu.map(function (item) {
        return "Ngày " + item.Ngay;
    });

    var data = danhSachDoanhThu.map(function (item) {
        return item.TongDoanhThu;
    });

    var ctx = document.getElementById('doanhThuChart').getContext('2d');
    var doanhThuChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Doanh thu',
                data: data,
                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                borderColor: 'rgba(75, 192, 192, 1)',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        } 
    });
</script>
